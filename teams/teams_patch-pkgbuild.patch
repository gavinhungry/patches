diff --color -ru teams.ORIG/PKGBUILD teams/PKGBUILD
--- teams.ORIG/PKGBUILD	2022-01-26 12:04:29.577517210 -0800
+++ teams/PKGBUILD	2022-01-26 12:12:43.661685838 -0800
@@ -23,4 +23,19 @@
   install -dm755 "${pkgdir}/usr/share/licenses/${pkgname}"
   mv "${pkgdir}/usr/share/${pkgname}/LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}"
   ln -s "/usr/share/licenses/${pkgname}/LICENSE" "${pkgdir}/usr/share/${pkgname}/LICENSE"
+
+  cp "${srcdir}"/icons/* "${pkgdir}"/usr/share/teams/resources/assets
+
+  _ASAR_PATH="${pkgdir}"/usr/share/teams/resources/app.asar
+  _ASAR_TMP=$(mktemp -dp "${srcdir}")
+
+  asar extract "${_ASAR_PATH}" "${_ASAR_TMP}"
+
+  js-beautify "${_ASAR_TMP}"/main.bundle.js > "${_ASAR_TMP}"/main.full.js
+  patch -d "${_ASAR_TMP}" -p0 < "${srcdir}"/switch-display-on-restore.diff
+  patch -d "${_ASAR_TMP}" -p0 < "${srcdir}"/log-status.diff
+  patch -d "${_ASAR_TMP}/lib/renderer/loading" -p0 < "${srcdir}"/loading-dark.diff
+  terser "${_ASAR_TMP}"/main.full.js > "${_ASAR_TMP}"/main.bundle.js
+  rm "${_ASAR_TMP}"/main.full.js
+  asar pack "${_ASAR_TMP}" "${_ASAR_PATH}"
 }
